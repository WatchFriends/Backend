function Socket(t,e,s){this.nsp=t,this.server=t.server,this.adapter=this.nsp.adapter,this.id="/"!==t.name?t.name+"#"+e.id:e.id,this.client=e,this.conn=e.conn,this.rooms={},this.acks={},this.connected=!0,this.disconnected=!1,this.handshake=this.buildHandshake(s),this.fns=[]}var Emitter=require("events").EventEmitter,parser=require("socket.io-parser"),url=require("url"),debug=require("debug")("socket.io:socket"),hasBin=require("has-binary"),assign=require("object-assign");module.exports=exports=Socket,exports.events=["error","connect","disconnect","disconnecting","newListener","removeListener"];var flags=["json","volatile","broadcast"],emit=Emitter.prototype.emit;Socket.prototype.__proto__=Emitter.prototype,flags.forEach(function(t){Socket.prototype.__defineGetter__(t,function(){return this.flags=this.flags||{},this.flags[t]=!0,this})}),Socket.prototype.__defineGetter__("request",function(){return this.conn.request}),Socket.prototype.buildHandshake=function(t){function e(){var e=url.parse(s.request.url,!0).query;return assign({},t,e)}var s=this;return{headers:this.request.headers,time:new Date+"",address:this.conn.remoteAddress,xdomain:!!this.request.headers.origin,secure:!!this.request.connection.encrypted,issued:+new Date,url:this.request.url,query:e()}},Socket.prototype.emit=function(t){if(~exports.events.indexOf(t))emit.apply(this,arguments);else{var e=Array.prototype.slice.call(arguments),s={};s.type=hasBin(e)?parser.BINARY_EVENT:parser.EVENT,s.data=e;var o=this.flags||{};if("function"==typeof e[e.length-1]){if(this._rooms||o.broadcast)throw new Error("Callbacks are not supported when broadcasting");debug("emitting packet with ack id %d",this.nsp.ids),this.acks[this.nsp.ids]=e.pop(),s.id=this.nsp.ids++}this._rooms||o.broadcast?this.adapter.broadcast(s,{except:[this.id],rooms:this._rooms,flags:o}):this.packet(s,{volatile:o.volatile,compress:o.compress}),delete this._rooms,delete this.flags}return this},Socket.prototype.to=Socket.prototype.in=function(t){return this._rooms=this._rooms||[],~this._rooms.indexOf(t)||this._rooms.push(t),this},Socket.prototype.send=Socket.prototype.write=function(){var t=Array.prototype.slice.call(arguments);return t.unshift("message"),this.emit.apply(this,t),this},Socket.prototype.packet=function(t,e){t.nsp=this.nsp.name,e=e||{},e.compress=!1!==e.compress,this.client.packet(t,e)},Socket.prototype.join=function(t,e){debug("joining room %s",t);var s=this;return this.rooms.hasOwnProperty(t)?(e&&e(null),this):(this.adapter.add(this.id,t,function(o){return o?e&&e(o):(debug("joined room %s",t),s.rooms[t]=t,void(e&&e(null)))}),this)},Socket.prototype.leave=function(t,e){debug("leave room %s",t);var s=this;return this.adapter.del(this.id,t,function(o){return o?e&&e(o):(debug("left room %s",t),delete s.rooms[t],void(e&&e(null)))}),this},Socket.prototype.leaveAll=function(){this.adapter.delAll(this.id),this.rooms={}},Socket.prototype.onconnect=function(){debug("socket connected - writing packet"),this.nsp.connected[this.id]=this,this.join(this.id),this.packet({type:parser.CONNECT})},Socket.prototype.onpacket=function(t){switch(debug("got packet %j",t),t.type){case parser.EVENT:this.onevent(t);break;case parser.BINARY_EVENT:this.onevent(t);break;case parser.ACK:this.onack(t);break;case parser.BINARY_ACK:this.onack(t);break;case parser.DISCONNECT:this.ondisconnect();break;case parser.ERROR:this.emit("error",t.data)}},Socket.prototype.onevent=function(t){var e=t.data||[];debug("emitting event %j",e),null!=t.id&&(debug("attaching ack callback to event"),e.push(this.ack(t.id))),this.dispatch(e)},Socket.prototype.ack=function(t){var e=this,s=!1;return function(){if(!s){var o=Array.prototype.slice.call(arguments);debug("sending ack %j",o);var i=hasBin(o)?parser.BINARY_ACK:parser.ACK;e.packet({id:t,type:i,data:o}),s=!0}}},Socket.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(debug("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):debug("bad ack %s",t.id)},Socket.prototype.ondisconnect=function(){debug("got disconnect packet"),this.onclose("client namespace disconnect")},Socket.prototype.onerror=function(t){this.listeners("error").length?this.emit("error",t):(console.error("Missing error handler on `socket`."),console.error(t.stack))},Socket.prototype.onclose=function(t){return this.connected?(debug("closing socket - reason %s",t),this.emit("disconnecting",t),this.leaveAll(),this.nsp.remove(this),this.client.remove(this),this.connected=!1,this.disconnected=!0,delete this.nsp.connected[this.id],void this.emit("disconnect",t)):this},Socket.prototype.error=function(t){this.packet({type:parser.ERROR,data:t})},Socket.prototype.disconnect=function(t){return this.connected?(t?this.client.disconnect():(this.packet({type:parser.DISCONNECT}),this.onclose("server namespace disconnect")),this):this},Socket.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this},Socket.prototype.dispatch=function(t){debug("dispatching an event %j",t);var e=this;this.run(t,function(s){process.nextTick(function(){return s?e.emit("error",s.data||s.message):void emit.apply(e,t)})})},Socket.prototype.use=function(t){return this.fns.push(t),this},Socket.prototype.run=function(t,e){function s(i){o[i](t,function(t){return t?e(t):o[i+1]?void s(i+1):e(null)})}var o=this.fns.slice(0);return o.length?void s(0):e(null)},function(){"use strict";function t(){e=io(),s=document.getElementsByClassName("btn--voting")}var e,s;t(),addEventListener()}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNvY2tldC5qcyIsInZvdGluZy5qcyJdLCJuYW1lcyI6WyJTb2NrZXQiLCJuc3AiLCJjbGllbnQiLCJxdWVyeSIsInRoaXMiLCJzZXJ2ZXIiLCJhZGFwdGVyIiwiaWQiLCJuYW1lIiwiY29ubiIsInJvb21zIiwiYWNrcyIsImNvbm5lY3RlZCIsImRpc2Nvbm5lY3RlZCIsImhhbmRzaGFrZSIsImJ1aWxkSGFuZHNoYWtlIiwiZm5zIiwiRW1pdHRlciIsInJlcXVpcmUiLCJFdmVudEVtaXR0ZXIiLCJwYXJzZXIiLCJ1cmwiLCJkZWJ1ZyIsImhhc0JpbiIsImFzc2lnbiIsIm1vZHVsZSIsImV4cG9ydHMiLCJldmVudHMiLCJmbGFncyIsImVtaXQiLCJwcm90b3R5cGUiLCJfX3Byb3RvX18iLCJmb3JFYWNoIiwiZmxhZyIsIl9fZGVmaW5lR2V0dGVyX18iLCJyZXF1ZXN0IiwiYnVpbGRRdWVyeSIsInJlcXVlc3RRdWVyeSIsInBhcnNlIiwic2VsZiIsImhlYWRlcnMiLCJ0aW1lIiwiRGF0ZSIsImFkZHJlc3MiLCJyZW1vdGVBZGRyZXNzIiwieGRvbWFpbiIsIm9yaWdpbiIsInNlY3VyZSIsImNvbm5lY3Rpb24iLCJlbmNyeXB0ZWQiLCJpc3N1ZWQiLCJldiIsImluZGV4T2YiLCJhcHBseSIsImFyZ3VtZW50cyIsImFyZ3MiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsInBhY2tldCIsInR5cGUiLCJCSU5BUllfRVZFTlQiLCJFVkVOVCIsImRhdGEiLCJsZW5ndGgiLCJfcm9vbXMiLCJicm9hZGNhc3QiLCJFcnJvciIsImlkcyIsInBvcCIsImV4Y2VwdCIsInZvbGF0aWxlIiwiY29tcHJlc3MiLCJ0byIsImluIiwicHVzaCIsInNlbmQiLCJ3cml0ZSIsInVuc2hpZnQiLCJvcHRzIiwiam9pbiIsInJvb20iLCJmbiIsImhhc093blByb3BlcnR5IiwiYWRkIiwiZXJyIiwibGVhdmUiLCJkZWwiLCJsZWF2ZUFsbCIsImRlbEFsbCIsIm9uY29ubmVjdCIsIkNPTk5FQ1QiLCJvbnBhY2tldCIsIm9uZXZlbnQiLCJBQ0siLCJvbmFjayIsIkJJTkFSWV9BQ0siLCJESVNDT05ORUNUIiwib25kaXNjb25uZWN0IiwiRVJST1IiLCJhY2siLCJkaXNwYXRjaCIsInNlbnQiLCJvbmNsb3NlIiwib25lcnJvciIsImxpc3RlbmVycyIsImNvbnNvbGUiLCJlcnJvciIsInN0YWNrIiwicmVhc29uIiwicmVtb3ZlIiwiZGlzY29ubmVjdCIsImNsb3NlIiwiZXZlbnQiLCJydW4iLCJwcm9jZXNzIiwibmV4dFRpY2siLCJtZXNzYWdlIiwidXNlIiwiaSIsImluaXQiLCJzb2NrZXQiLCJpbyIsInZvdGluZ0J1dHRvbnMiLCJkb2N1bWVudCIsImdldEVsZW1lbnRzQnlDbGFzc05hbWUiLCJhZGRFdmVudExpc3RlbmVyIl0sIm1hcHBpbmdzIjoiQUEyREEsUUFBQUEsUUFBQUMsRUFBQUMsRUFBQUMsR0FDQUMsS0FBQUgsSUFBQUEsRUFDQUcsS0FBQUMsT0FBQUosRUFBQUksT0FDQUQsS0FBQUUsUUFBQUYsS0FBQUgsSUFBQUssUUFDQUYsS0FBQUcsR0FBQSxNQUFBTixFQUFBTyxLQUFBUCxFQUFBTyxLQUFBLElBQUFOLEVBQUFLLEdBQUFMLEVBQUFLLEdBQ0FILEtBQUFGLE9BQUFBLEVBQ0FFLEtBQUFLLEtBQUFQLEVBQUFPLEtBQ0FMLEtBQUFNLFNBQ0FOLEtBQUFPLFFBQ0FQLEtBQUFRLFdBQUEsRUFDQVIsS0FBQVMsY0FBQSxFQUNBVCxLQUFBVSxVQUFBVixLQUFBVyxlQUFBWixHQUNBQyxLQUFBWSxPQWxFQSxHQUFBQyxTQUFBQyxRQUFBLFVBQUFDLGFBQ0FDLE9BQUFGLFFBQUEsb0JBQ0FHLElBQUFILFFBQUEsT0FDQUksTUFBQUosUUFBQSxTQUFBLG9CQUNBSyxPQUFBTCxRQUFBLGNBQ0FNLE9BQUFOLFFBQUEsZ0JBTUFPLFFBQUFDLFFBQUFBLFFBQUExQixPQVFBMEIsUUFBQUMsUUFDQSxRQUNBLFVBQ0EsYUFDQSxnQkFDQSxjQUNBLGlCQVNBLElBQUFDLFFBQ0EsT0FDQSxXQUNBLGFB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NUIsR0FFQSxNQUFBQSxHQUFBSCxFQUFBRyxHQUdBckUsRUFBQXVHLEVBQUEsT0FHQUwsR0FBQUssRUFBQSxHQUhBckMsRUFBQSxRQVRBLEdBQUFsRSxHQUFBWixLQUFBWSxJQUFBeUMsTUFBQSxFQUNBLE9BQUF6QyxHQUFBZ0QsV0FlQWtELEdBQUEsR0FmQWhDLEVBQUEsT0MzZ0JBLFdBQ0EsWUFJQSxTQUFBc0MsS0FFQUMsRUFBQUMsS0FDQUMsRUFBQUMsU0FBQUMsdUJBQUEsZUFMQSxHQUFBSixHQUFBRSxDQW1CQUgsS0FDQU0iLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxyXG4vKipcclxuICogTW9kdWxlIGRlcGVuZGVuY2llcy5cclxuICovXHJcblxyXG52YXIgRW1pdHRlciA9IHJlcXVpcmUoJ2V2ZW50cycpLkV2ZW50RW1pdHRlcjtcclxudmFyIHBhcnNlciA9IHJlcXVpcmUoJ3NvY2tldC5pby1wYXJzZXInKTtcclxudmFyIHVybCA9IHJlcXVpcmUoJ3VybCcpO1xyXG52YXIgZGVidWcgPSByZXF1aXJlKCdkZWJ1ZycpKCdzb2NrZXQuaW86c29ja2V0Jyk7XHJcbnZhciBoYXNCaW4gPSByZXF1aXJlKCdoYXMtYmluYXJ5Jyk7XHJcbnZhciBhc3NpZ24gPSByZXF1aXJlKCdvYmplY3QtYXNzaWduJyk7XHJcblxyXG4vKipcclxuICogTW9kdWxlIGV4cG9ydHMuXHJcbiAqL1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBleHBvcnRzID0gU29ja2V0O1xyXG5cclxuLyoqXHJcbiAqIEJsYWNrbGlzdGVkIGV2ZW50cy5cclxuICpcclxuICogQGFwaSBwdWJsaWNcclxuICovXHJcblxyXG5leHBvcnRzLmV2ZW50cyA9IFtcclxuICAnZXJyb3InLFxyXG4gICdjb25uZWN0JyxcclxuICAnZGlzY29ubmVjdCcsXHJcbiAgJ2Rpc2Nvbm5lY3RpbmcnLFxyXG4gICduZXdMaXN0ZW5lcicsXHJcbiAgJ3JlbW92ZUxpc3RlbmVyJ1xyXG5dO1xyXG5cclxuLyoqXHJcbiAqIEZsYWdzLlxyXG4gKlxyXG4gKiBAYXBpIHByaXZhdGVcclxuICovXHJcblxyXG52YXIgZmxhZ3MgPSBbXHJcbiAgJ2pzb24nLFxyXG4gICd2b2xhdGlsZScsXHJcbiAgJ2Jyb2FkY2FzdCdcclxuXTtcclxuXHJcbi8qKlxyXG4gKiBgRXZlbnRFbWl0dGVyI2VtaXRgIHJlZmVyZW5jZS5cclxuICovXHJcblxyXG52YXIgZW1pdCA9IEVtaXR0ZXIucHJvdG90eXBlLmVtaXQ7XHJcblxyXG4vKipcclxuICogSW50ZXJmYWNlIHRvIGEgYENsaWVudGAgZm9yIGEgZ2l2ZW4gYE5hbWVzcGFjZWAuXHJcbiAqXHJcbiAqIEBwYXJhbSB7TmFtZXNwYWNlfSBuc3BcclxuICogQHBhcmFtIHtDbGllbnR9IGNsaWVudFxyXG4gKiBAYXBpIHB1YmxpY1xyXG4gKi9cclxuXHJcbmZ1bmN0aW9uIFNvY2tldChuc3AsIGNsaWVudCwgcXVlcnkpe1xyXG4gIHRoaXMubnNwID0gbnNwO1xyXG4gIHRoaXMuc2VydmVyID0gbnNwLnNlcnZlcjtcclxuICB0aGlzLmFkYXB0ZXIgPSB0aGlzLm5zcC5hZGFwdGVyO1xyXG4gIHRoaXMuaWQgPSBuc3AubmFtZSAhPT0gJy8nID8gbnNwLm5hbWUgKyAnIycgKyBjbGllbnQuaWQgOiBjbGllbnQuaWQ7XHJcbiAgdGhpcy5jbGllbnQgPSBjbGllbnQ7XHJcbiAgdGhpcy5jb25uID0gY2xpZW50LmNvbm47XHJcbiAgdGhpcy5yb29tcyA9IHt9O1xyXG4gIHRoaXMuYWNrcyA9IHt9O1xyXG4gIHRoaXMuY29ubmVjdGVkID0gdHJ1ZTtcclxuICB0aGlzLmRpc2Nvbm5lY3RlZCA9IGZhbHNlO1xyXG4gIHRoaXMuaGFuZHNoYWtlID0gdGhpcy5idWlsZEhhbmRzaGFrZShxdWVyeSk7XHJcbiAgdGhpcy5mbnMgPSBbXTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaGVyaXRzIGZyb20gYEV2ZW50RW1pdHRlcmAuXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5fX3Byb3RvX18gPSBFbWl0dGVyLnByb3RvdHlwZTtcclxuXHJcbi8qKlxyXG4gKiBBcHBseSBmbGFncyBmcm9tIGBTb2NrZXRgLlxyXG4gKi9cclxuXHJcbmZsYWdzLmZvckVhY2goZnVuY3Rpb24oZmxhZyl7XHJcbiAgU29ja2V0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fKGZsYWcsIGZ1bmN0aW9uKCl7XHJcbiAgICB0aGlzLmZsYWdzID0gdGhpcy5mbGFncyB8fCB7fTtcclxuICAgIHRoaXMuZmxhZ3NbZmxhZ10gPSB0cnVlO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfSk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIGByZXF1ZXN0YCBlbmdpbmUuaW8gc2hvcnRjdXQuXHJcbiAqXHJcbiAqIEBhcGkgcHVibGljXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5fX2RlZmluZUdldHRlcl9fKCdyZXF1ZXN0JywgZnVuY3Rpb24oKXtcclxuICByZXR1cm4gdGhpcy5jb25uLnJlcXVlc3Q7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEJ1aWxkcyB0aGUgYGhhbmRzaGFrZWAgQkMgb2JqZWN0XHJcbiAqXHJcbiAqIEBhcGkgcHJpdmF0ZVxyXG4gKi9cclxuXHJcblNvY2tldC5wcm90b3R5cGUuYnVpbGRIYW5kc2hha2UgPSBmdW5jdGlvbihxdWVyeSl7XHJcbiAgdmFyIHNlbGYgPSB0aGlzO1xyXG4gIGZ1bmN0aW9uIGJ1aWxkUXVlcnkoKXtcclxuICAgIHZhciByZXF1ZXN0UXVlcnkgPSB1cmwucGFyc2Uoc2VsZi5yZXF1ZXN0LnVybCwgdHJ1ZSkucXVlcnk7XHJcbiAgICAvL2lmIHNvY2tldC1zcGVjaWZpYyBxdWVyeSBleGlzdCwgcmVwbGFjZSBxdWVyeSBzdHJpbmdzIGluIHJlcXVlc3RRdWVyeVxyXG4gICAgcmV0dXJuIGFzc2lnbih7fSwgcXVlcnksIHJlcXVlc3RRdWVyeSk7XHJcbiAgfVxyXG4gIHJldHVybiB7XHJcbiAgICBoZWFkZXJzOiB0aGlzLnJlcXVlc3QuaGVhZGVycyxcclxuICAgIHRpbWU6IChuZXcgRGF0ZSkgKyAnJyxcclxuICAgIGFkZHJlc3M6IHRoaXMuY29ubi5yZW1vdGVBZGRyZXNzLFxyXG4gICAgeGRvbWFpbjogISF0aGlzLnJlcXVlc3QuaGVhZGVycy5vcmlnaW4sXHJcbiAgICBzZWN1cmU6ICEhdGhpcy5yZXF1ZXN0LmNvbm5lY3Rpb24uZW5jcnlwdGVkLFxyXG4gICAgaXNzdWVkOiArKG5ldyBEYXRlKSxcclxuICAgIHVybDogdGhpcy5yZXF1ZXN0LnVybCxcclxuICAgIHF1ZXJ5OiBidWlsZFF1ZXJ5KClcclxuICB9O1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEVtaXRzIHRvIHRoaXMgY2xpZW50LlxyXG4gKlxyXG4gKiBAcmV0dXJuIHtTb2NrZXR9IHNlbGZcclxuICogQGFwaSBwdWJsaWNcclxuICovXHJcblxyXG5Tb2NrZXQucHJvdG90eXBlLmVtaXQgPSBmdW5jdGlvbihldil7XHJcbiAgaWYgKH5leHBvcnRzLmV2ZW50cy5pbmRleE9mKGV2KSkge1xyXG4gICAgZW1pdC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB2YXIgYXJncyA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cyk7XHJcbiAgICB2YXIgcGFja2V0ID0ge307XHJcbiAgICBwYWNrZXQudHlwZSA9IGhhc0JpbihhcmdzKSA/IHBhcnNlci5CSU5BUllfRVZFTlQgOiBwYXJzZXIuRVZFTlQ7XHJcbiAgICBwYWNrZXQuZGF0YSA9IGFyZ3M7XHJcbiAgICB2YXIgZmxhZ3MgPSB0aGlzLmZsYWdzIHx8IHt9O1xyXG5cclxuICAgIC8vIGFjY2VzcyBsYXN0IGFyZ3VtZW50IHRvIHNlZSBpZiBpdCdzIGFuIEFDSyBjYWxsYmFja1xyXG4gICAgaWYgKCdmdW5jdGlvbicgPT0gdHlwZW9mIGFyZ3NbYXJncy5sZW5ndGggLSAxXSkge1xyXG4gICAgICBpZiAodGhpcy5fcm9vbXMgfHwgZmxhZ3MuYnJvYWRjYXN0KSB7XHJcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYWxsYmFja3MgYXJlIG5vdCBzdXBwb3J0ZWQgd2hlbiBicm9hZGNhc3RpbmcnKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZGVidWcoJ2VtaXR0aW5nIHBhY2tldCB3aXRoIGFjayBpZCAlZCcsIHRoaXMubnNwLmlkcyk7XHJcbiAgICAgIHRoaXMuYWNrc1t0aGlzLm5zcC5pZHNdID0gYXJncy5wb3AoKTtcclxuICAgICAgcGFja2V0LmlkID0gdGhpcy5uc3AuaWRzKys7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuX3Jvb21zIHx8IGZsYWdzLmJyb2FkY2FzdCkge1xyXG4gICAgICB0aGlzLmFkYXB0ZXIuYnJvYWRjYXN0KHBhY2tldCwge1xyXG4gICAgICAgIGV4Y2VwdDogW3RoaXMuaWRdLFxyXG4gICAgICAgIHJvb21zOiB0aGlzLl9yb29tcyxcclxuICAgICAgICBmbGFnczogZmxhZ3NcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBkaXNwYXRjaCBwYWNrZXRcclxuICAgICAgdGhpcy5wYWNrZXQocGFja2V0LCB7XHJcbiAgICAgICAgdm9sYXRpbGU6IGZsYWdzLnZvbGF0aWxlLFxyXG4gICAgICAgIGNvbXByZXNzOiBmbGFncy5jb21wcmVzc1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyByZXNldCBmbGFnc1xyXG4gICAgZGVsZXRlIHRoaXMuX3Jvb21zO1xyXG4gICAgZGVsZXRlIHRoaXMuZmxhZ3M7XHJcbiAgfVxyXG4gIHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFRhcmdldHMgYSByb29tIHdoZW4gYnJvYWRjYXN0aW5nLlxyXG4gKlxyXG4gKiBAcGFyYW0ge1N0cmluZ30gbmFtZVxyXG4gKiBAcmV0dXJuIHtTb2NrZXR9IHNlbGZcclxuICogQGFwaSBwdWJsaWNcclxuICovXHJcblxyXG5Tb2NrZXQucHJvdG90eXBlLnRvID1cclxuU29ja2V0LnByb3RvdHlwZS5pbiA9IGZ1bmN0aW9uKG5hbWUpe1xyXG4gIHRoaXMuX3Jvb21zID0gdGhpcy5fcm9vbXMgfHwgW107XHJcbiAgaWYgKCF+dGhpcy5fcm9vbXMuaW5kZXhPZihuYW1lKSkgdGhpcy5fcm9vbXMucHVzaChuYW1lKTtcclxuICByZXR1cm4gdGhpcztcclxufTtcclxuXHJcbi8qKlxyXG4gKiBTZW5kcyBhIGBtZXNzYWdlYCBldmVudC5cclxuICpcclxuICogQHJldHVybiB7U29ja2V0fSBzZWxmXHJcbiAqIEBhcGkgcHVibGljXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5zZW5kID1cclxuU29ja2V0LnByb3RvdHlwZS53cml0ZSA9IGZ1bmN0aW9uKCl7XHJcbiAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xyXG4gIGFyZ3MudW5zaGlmdCgnbWVzc2FnZScpO1xyXG4gIHRoaXMuZW1pdC5hcHBseSh0aGlzLCBhcmdzKTtcclxuICByZXR1cm4gdGhpcztcclxufTtcclxuXHJcbi8qKlxyXG4gKiBXcml0ZXMgYSBwYWNrZXQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXQgb2JqZWN0XHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBvcHRzIG9wdGlvbnNcclxuICogQGFwaSBwcml2YXRlXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5wYWNrZXQgPSBmdW5jdGlvbihwYWNrZXQsIG9wdHMpe1xyXG4gIHBhY2tldC5uc3AgPSB0aGlzLm5zcC5uYW1lO1xyXG4gIG9wdHMgPSBvcHRzIHx8IHt9O1xyXG4gIG9wdHMuY29tcHJlc3MgPSBmYWxzZSAhPT0gb3B0cy5jb21wcmVzcztcclxuICB0aGlzLmNsaWVudC5wYWNrZXQocGFja2V0LCBvcHRzKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBKb2lucyBhIHJvb20uXHJcbiAqXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSByb29tXHJcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIG9wdGlvbmFsLCBjYWxsYmFja1xyXG4gKiBAcmV0dXJuIHtTb2NrZXR9IHNlbGZcclxuICogQGFwaSBwcml2YXRlXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5qb2luID0gZnVuY3Rpb24ocm9vbSwgZm4pe1xyXG4gIGRlYnVnKCdqb2luaW5nIHJvb20gJXMnLCByb29tKTtcclxuICB2YXIgc2VsZiA9IHRoaXM7XHJcbiAgaWYgKHRoaXMucm9vbXMuaGFzT3duUHJvcGVydHkocm9vbSkpIHtcclxuICAgIGZuICYmIGZuKG51bGwpO1xyXG4gICAgcmV0dXJuIHRoaXM7XHJcbiAgfVxyXG4gIHRoaXMuYWRhcHRlci5hZGQodGhpcy5pZCwgcm9vbSwgZnVuY3Rpb24oZXJyKXtcclxuICAgIGlmIChlcnIpIHJldHVybiBmbiAmJiBmbihlcnIpO1xyXG4gICAgZGVidWcoJ2pvaW5lZCByb29tICVzJywgcm9vbSk7XHJcbiAgICBzZWxmLnJvb21zW3Jvb21dID0gcm9vbTtcclxuICAgIGZuICYmIGZuKG51bGwpO1xyXG4gIH0pO1xyXG4gIHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIExlYXZlcyBhIHJvb20uXHJcbiAqXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSByb29tXHJcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIG9wdGlvbmFsLCBjYWxsYmFja1xyXG4gKiBAcmV0dXJuIHtTb2NrZXR9IHNlbGZcclxuICogQGFwaSBwcml2YXRlXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5sZWF2ZSA9IGZ1bmN0aW9uKHJvb20sIGZuKXtcclxuICBkZWJ1ZygnbGVhdmUgcm9vbSAlcycsIHJvb20pO1xyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICB0aGlzLmFkYXB0ZXIuZGVsKHRoaXMuaWQsIHJvb20sIGZ1bmN0aW9uKGVycil7XHJcbiAgICBpZiAoZXJyKSByZXR1cm4gZm4gJiYgZm4oZXJyKTtcclxuICAgIGRlYnVnKCdsZWZ0IHJvb20gJXMnLCByb29tKTtcclxuICAgIGRlbGV0ZSBzZWxmLnJvb21zW3Jvb21dO1xyXG4gICAgZm4gJiYgZm4obnVsbCk7XHJcbiAgfSk7XHJcbiAgcmV0dXJuIHRoaXM7XHJcbn07XHJcblxyXG4vKipcclxuICogTGVhdmUgYWxsIHJvb21zLlxyXG4gKlxyXG4gKiBAYXBpIHByaXZhdGVcclxuICovXHJcblxyXG5Tb2NrZXQucHJvdG90eXBlLmxlYXZlQWxsID0gZnVuY3Rpb24oKXtcclxuICB0aGlzLmFkYXB0ZXIuZGVsQWxsKHRoaXMuaWQpO1xyXG4gIHRoaXMucm9vbXMgPSB7fTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDYWxsZWQgYnkgYE5hbWVzcGFjZWAgdXBvbiBzdWNjZXNzZnVsXHJcbiAqIG1pZGRsZXdhcmUgZXhlY3V0aW9uIChpZTogYXV0aG9yaXphdGlvbikuXHJcbiAqXHJcbiAqIEBhcGkgcHJpdmF0ZVxyXG4gKi9cclxuXHJcblNvY2tldC5wcm90b3R5cGUub25jb25uZWN0ID0gZnVuY3Rpb24oKXtcclxuICBkZWJ1Zygnc29ja2V0IGNvbm5lY3RlZCAtIHdyaXRpbmcgcGFja2V0Jyk7XHJcbiAgdGhpcy5uc3AuY29ubmVjdGVkW3RoaXMuaWRdID0gdGhpcztcclxuICB0aGlzLmpvaW4odGhpcy5pZCk7XHJcbiAgdGhpcy5wYWNrZXQoeyB0eXBlOiBwYXJzZXIuQ09OTkVDVCB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDYWxsZWQgd2l0aCBlYWNoIHBhY2tldC4gQ2FsbGVkIGJ5IGBDbGllbnRgLlxyXG4gKlxyXG4gKiBAcGFyYW0ge09iamVjdH0gcGFja2V0XHJcbiAqIEBhcGkgcHJpdmF0ZVxyXG4gKi9cclxuXHJcblNvY2tldC5wcm90b3R5cGUub25wYWNrZXQgPSBmdW5jdGlvbihwYWNrZXQpe1xyXG4gIGRlYnVnKCdnb3QgcGFja2V0ICVqJywgcGFja2V0KTtcclxuICBzd2l0Y2ggKHBhY2tldC50eXBlKSB7XHJcbiAgICBjYXNlIHBhcnNlci5FVkVOVDpcclxuICAgICAgdGhpcy5vbmV2ZW50KHBhY2tldCk7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgcGFyc2VyLkJJTkFSWV9FVkVOVDpcclxuICAgICAgdGhpcy5vbmV2ZW50KHBhY2tldCk7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgcGFyc2VyLkFDSzpcclxuICAgICAgdGhpcy5vbmFjayhwYWNrZXQpO1xyXG4gICAgICBicmVhaztcclxuXHJcbiAgICBjYXNlIHBhcnNlci5CSU5BUllfQUNLOlxyXG4gICAgICB0aGlzLm9uYWNrKHBhY2tldCk7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgcGFyc2VyLkRJU0NPTk5FQ1Q6XHJcbiAgICAgIHRoaXMub25kaXNjb25uZWN0KCk7XHJcbiAgICAgIGJyZWFrO1xyXG5cclxuICAgIGNhc2UgcGFyc2VyLkVSUk9SOlxyXG4gICAgICB0aGlzLmVtaXQoJ2Vycm9yJywgcGFja2V0LmRhdGEpO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDYWxsZWQgdXBvbiBldmVudCBwYWNrZXQuXHJcbiAqXHJcbiAqIEBwYXJhbSB7T2JqZWN0fSBwYWNrZXQgb2JqZWN0XHJcbiAqIEBhcGkgcHJpdmF0ZVxyXG4gKi9cclxuXHJcblNvY2tldC5wcm90b3R5cGUub25ldmVudCA9IGZ1bmN0aW9uKHBhY2tldCl7XHJcbiAgdmFyIGFyZ3MgPSBwYWNrZXQuZGF0YSB8fCBbXTtcclxuICBkZWJ1ZygnZW1pdHRpbmcgZXZlbnQgJWonLCBhcmdzKTtcclxuXHJcbiAgaWYgKG51bGwgIT0gcGFja2V0LmlkKSB7XHJcbiAgICBkZWJ1ZygnYXR0YWNoaW5nIGFjayBjYWxsYmFjayB0byBldmVudCcpO1xyXG4gICAgYXJncy5wdXNoKHRoaXMuYWNrKHBhY2tldC5pZCkpO1xyXG4gIH1cclxuXHJcbiAgdGhpcy5kaXNwYXRjaChhcmdzKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBQcm9kdWNlcyBhbiBhY2sgY2FsbGJhY2sgdG8gZW1pdCB3aXRoIGFuIGV2ZW50LlxyXG4gKlxyXG4gKiBAcGFyYW0ge051bWJlcn0gaWQgcGFja2V0IGlkXHJcbiAqIEBhcGkgcHJpdmF0ZVxyXG4gKi9cclxuXHJcblNvY2tldC5wcm90b3R5cGUuYWNrID0gZnVuY3Rpb24oaWQpe1xyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICB2YXIgc2VudCA9IGZhbHNlO1xyXG4gIHJldHVybiBmdW5jdGlvbigpe1xyXG4gICAgLy8gcHJldmVudCBkb3VibGUgY2FsbGJhY2tzXHJcbiAgICBpZiAoc2VudCkgcmV0dXJuO1xyXG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMpO1xyXG4gICAgZGVidWcoJ3NlbmRpbmcgYWNrICVqJywgYXJncyk7XHJcblxyXG4gICAgdmFyIHR5cGUgPSBoYXNCaW4oYXJncykgPyBwYXJzZXIuQklOQVJZX0FDSyA6IHBhcnNlci5BQ0s7XHJcbiAgICBzZWxmLnBhY2tldCh7XHJcbiAgICAgIGlkOiBpZCxcclxuICAgICAgdHlwZTogdHlwZSxcclxuICAgICAgZGF0YTogYXJnc1xyXG4gICAgfSk7XHJcblxyXG4gICAgc2VudCA9IHRydWU7XHJcbiAgfTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBDYWxsZWQgdXBvbiBhY2sgcGFja2V0LlxyXG4gKlxyXG4gKiBAYXBpIHByaXZhdGVcclxuICovXHJcblxyXG5Tb2NrZXQucHJvdG90eXBlLm9uYWNrID0gZnVuY3Rpb24ocGFja2V0KXtcclxuICB2YXIgYWNrID0gdGhpcy5hY2tzW3BhY2tldC5pZF07XHJcbiAgaWYgKCdmdW5jdGlvbicgPT0gdHlwZW9mIGFjaykge1xyXG4gICAgZGVidWcoJ2NhbGxpbmcgYWNrICVzIHdpdGggJWonLCBwYWNrZXQuaWQsIHBhY2tldC5kYXRhKTtcclxuICAgIGFjay5hcHBseSh0aGlzLCBwYWNrZXQuZGF0YSk7XHJcbiAgICBkZWxldGUgdGhpcy5hY2tzW3BhY2tldC5pZF07XHJcbiAgfSBlbHNlIHtcclxuICAgIGRlYnVnKCdiYWQgYWNrICVzJywgcGFja2V0LmlkKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogQ2FsbGVkIHVwb24gY2xpZW50IGRpc2Nvbm5lY3QgcGFja2V0LlxyXG4gKlxyXG4gKiBAYXBpIHByaXZhdGVcclxuICovXHJcblxyXG5Tb2NrZXQucHJvdG90eXBlLm9uZGlzY29ubmVjdCA9IGZ1bmN0aW9uKCl7XHJcbiAgZGVidWcoJ2dvdCBkaXNjb25uZWN0IHBhY2tldCcpO1xyXG4gIHRoaXMub25jbG9zZSgnY2xpZW50IG5hbWVzcGFjZSBkaXNjb25uZWN0Jyk7XHJcbn07XHJcblxyXG4vKipcclxuICogSGFuZGxlcyBhIGNsaWVudCBlcnJvci5cclxuICpcclxuICogQGFwaSBwcml2YXRlXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5vbmVycm9yID0gZnVuY3Rpb24oZXJyKXtcclxuICBpZiAodGhpcy5saXN0ZW5lcnMoJ2Vycm9yJykubGVuZ3RoKSB7XHJcbiAgICB0aGlzLmVtaXQoJ2Vycm9yJywgZXJyKTtcclxuICB9IGVsc2Uge1xyXG4gICAgY29uc29sZS5lcnJvcignTWlzc2luZyBlcnJvciBoYW5kbGVyIG9uIGBzb2NrZXRgLicpO1xyXG4gICAgY29uc29sZS5lcnJvcihlcnIuc3RhY2spO1xyXG4gIH1cclxufTtcclxuXHJcbi8qKlxyXG4gKiBDYWxsZWQgdXBvbiBjbG9zaW5nLiBDYWxsZWQgYnkgYENsaWVudGAuXHJcbiAqXHJcbiAqIEBwYXJhbSB7U3RyaW5nfSByZWFzb25cclxuICogQHRocm93IHtFcnJvcn0gb3B0aW9uYWwgZXJyb3Igb2JqZWN0XHJcbiAqIEBhcGkgcHJpdmF0ZVxyXG4gKi9cclxuXHJcblNvY2tldC5wcm90b3R5cGUub25jbG9zZSA9IGZ1bmN0aW9uKHJlYXNvbil7XHJcbiAgaWYgKCF0aGlzLmNvbm5lY3RlZCkgcmV0dXJuIHRoaXM7XHJcbiAgZGVidWcoJ2Nsb3Npbmcgc29ja2V0IC0gcmVhc29uICVzJywgcmVhc29uKTtcclxuICB0aGlzLmVtaXQoJ2Rpc2Nvbm5lY3RpbmcnLCByZWFzb24pO1xyXG4gIHRoaXMubGVhdmVBbGwoKTtcclxuICB0aGlzLm5zcC5yZW1vdmUodGhpcyk7XHJcbiAgdGhpcy5jbGllbnQucmVtb3ZlKHRoaXMpO1xyXG4gIHRoaXMuY29ubmVjdGVkID0gZmFsc2U7XHJcbiAgdGhpcy5kaXNjb25uZWN0ZWQgPSB0cnVlO1xyXG4gIGRlbGV0ZSB0aGlzLm5zcC5jb25uZWN0ZWRbdGhpcy5pZF07XHJcbiAgdGhpcy5lbWl0KCdkaXNjb25uZWN0JywgcmVhc29uKTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBQcm9kdWNlcyBhbiBgZXJyb3JgIHBhY2tldC5cclxuICpcclxuICogQHBhcmFtIHtPYmplY3R9IGVyciBlcnJvciBvYmplY3RcclxuICogQGFwaSBwcml2YXRlXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5lcnJvciA9IGZ1bmN0aW9uKGVycil7XHJcbiAgdGhpcy5wYWNrZXQoeyB0eXBlOiBwYXJzZXIuRVJST1IsIGRhdGE6IGVyciB9KTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBEaXNjb25uZWN0cyB0aGlzIGNsaWVudC5cclxuICpcclxuICogQHBhcmFtIHtCb29sZWFufSBjbG9zZSBpZiBgdHJ1ZWAsIGNsb3NlcyB0aGUgdW5kZXJseWluZyBjb25uZWN0aW9uXHJcbiAqIEByZXR1cm4ge1NvY2tldH0gc2VsZlxyXG4gKiBAYXBpIHB1YmxpY1xyXG4gKi9cclxuXHJcblNvY2tldC5wcm90b3R5cGUuZGlzY29ubmVjdCA9IGZ1bmN0aW9uKGNsb3NlKXtcclxuICBpZiAoIXRoaXMuY29ubmVjdGVkKSByZXR1cm4gdGhpcztcclxuICBpZiAoY2xvc2UpIHtcclxuICAgIHRoaXMuY2xpZW50LmRpc2Nvbm5lY3QoKTtcclxuICB9IGVsc2Uge1xyXG4gICAgdGhpcy5wYWNrZXQoeyB0eXBlOiBwYXJzZXIuRElTQ09OTkVDVCB9KTtcclxuICAgIHRoaXMub25jbG9zZSgnc2VydmVyIG5hbWVzcGFjZSBkaXNjb25uZWN0Jyk7XHJcbiAgfVxyXG4gIHJldHVybiB0aGlzO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNldHMgdGhlIGNvbXByZXNzIGZsYWcuXHJcbiAqXHJcbiAqIEBwYXJhbSB7Qm9vbGVhbn0gY29tcHJlc3MgaWYgYHRydWVgLCBjb21wcmVzc2VzIHRoZSBzZW5kaW5nIGRhdGFcclxuICogQHJldHVybiB7U29ja2V0fSBzZWxmXHJcbiAqIEBhcGkgcHVibGljXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS5jb21wcmVzcyA9IGZ1bmN0aW9uKGNvbXByZXNzKXtcclxuICB0aGlzLmZsYWdzID0gdGhpcy5mbGFncyB8fCB7fTtcclxuICB0aGlzLmZsYWdzLmNvbXByZXNzID0gY29tcHJlc3M7XHJcbiAgcmV0dXJuIHRoaXM7XHJcbn07XHJcblxyXG4vKipcclxuICogRGlzcGF0Y2ggaW5jb21pbmcgZXZlbnQgdG8gc29ja2V0IGxpc3RlbmVycy5cclxuICpcclxuICogQHBhcmFtIHtBcnJheX0gZXZlbnQgdGhhdCB3aWxsIGdldCBlbWl0dGVkXHJcbiAqIEBhcGkgcHJpdmF0ZVxyXG4gKi9cclxuXHJcblNvY2tldC5wcm90b3R5cGUuZGlzcGF0Y2ggPSBmdW5jdGlvbihldmVudCl7XHJcbiAgZGVidWcoJ2Rpc3BhdGNoaW5nIGFuIGV2ZW50ICVqJywgZXZlbnQpO1xyXG4gIHZhciBzZWxmID0gdGhpcztcclxuICB0aGlzLnJ1bihldmVudCwgZnVuY3Rpb24oZXJyKXtcclxuICAgIHByb2Nlc3MubmV4dFRpY2soZnVuY3Rpb24oKXtcclxuICAgICAgaWYgKGVycikge1xyXG4gICAgICAgIHJldHVybiBzZWxmLmVtaXQoJ2Vycm9yJywgZXJyLmRhdGEgfHwgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICB9XHJcbiAgICAgIGVtaXQuYXBwbHkoc2VsZiwgZXZlbnQpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXRzIHVwIHNvY2tldCBtaWRkbGV3YXJlLlxyXG4gKlxyXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBtaWRkbGV3YXJlIGZ1bmN0aW9uIChldmVudCwgbmV4dClcclxuICogQHJldHVybiB7U29ja2V0fSBzZWxmXHJcbiAqIEBhcGkgcHVibGljXHJcbiAqL1xyXG5cclxuU29ja2V0LnByb3RvdHlwZS51c2UgPSBmdW5jdGlvbihmbil7XHJcbiAgdGhpcy5mbnMucHVzaChmbik7XHJcbiAgcmV0dXJuIHRoaXM7XHJcbn07XHJcblxyXG4vKipcclxuICogRXhlY3V0ZXMgdGhlIG1pZGRsZXdhcmUgZm9yIGFuIGluY29taW5nIGV2ZW50LlxyXG4gKlxyXG4gKiBAcGFyYW0ge0FycmF5fSBldmVudCB0aGF0IHdpbGwgZ2V0IGVtaXR0ZWRcclxuICogQHBhcmFtIHtGdW5jdGlvbn0gbGFzdCBmbiBjYWxsIGluIHRoZSBtaWRkbGV3YXJlXHJcbiAqIEBhcGkgcHJpdmF0ZVxyXG4gKi9cclxuU29ja2V0LnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbihldmVudCwgZm4pe1xyXG4gIHZhciBmbnMgPSB0aGlzLmZucy5zbGljZSgwKTtcclxuICBpZiAoIWZucy5sZW5ndGgpIHJldHVybiBmbihudWxsKTtcclxuXHJcbiAgZnVuY3Rpb24gcnVuKGkpe1xyXG4gICAgZm5zW2ldKGV2ZW50LCBmdW5jdGlvbihlcnIpe1xyXG4gICAgICAvLyB1cG9uIGVycm9yLCBzaG9ydC1jaXJjdWl0XHJcbiAgICAgIGlmIChlcnIpIHJldHVybiBmbihlcnIpO1xyXG5cclxuICAgICAgLy8gaWYgbm8gbWlkZGxld2FyZSBsZWZ0LCBzdW1tb24gY2FsbGJhY2tcclxuICAgICAgaWYgKCFmbnNbaSArIDFdKSByZXR1cm4gZm4obnVsbCk7XHJcblxyXG4gICAgICAvLyBnbyBvbiB0byBuZXh0XHJcbiAgICAgIHJ1bihpICsgMSk7XHJcbiAgICB9KTsgXHJcbiAgfVxyXG5cclxuICBydW4oMCk7XHJcbn07ICIsIihmdW5jdGlvbigpe1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gICAgdmFyIHNvY2tldCwgdm90aW5nQnV0dG9ucztcclxuXHJcbiAgICBmdW5jdGlvbiBpbml0KCl7XHJcblxyXG4gICAgICAgIHNvY2tldCA9IGlvKCk7XHJcbiAgICAgICAgdm90aW5nQnV0dG9ucyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoXCJidG4tLXZvdGluZ1wiKTtcclxuICAgIH1cclxuXHJcbiAgICBmdW5jdGlvbiBhZGRFdmVudExpc3RlbmVycygpIHtcclxuICAgICAgICBcclxuICAgICAgICBmb3IgKHZhciBpID0gdm90aW5nQnV0dG9ucy5sZW5naHQ7IGktLTsgKSB7XHJcblxyXG4gICAgICAgICAgICB2b3RpbmdCdXR0b25zW2ldLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgc29ja2V0LmVtaXQoJ3ZvdGUnLCAoZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50KS5kYXRhc2V0LnZvdGUpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgaW5pdCgpO1xyXG4gICAgYWRkRXZlbnRMaXN0ZW5lcigpO1xyXG59KCkpOyJdfQ==
